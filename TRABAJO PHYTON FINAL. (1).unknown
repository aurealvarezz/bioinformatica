{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "eaebb484",
   "metadata": {},
   "source": [
    "# TRABAJO DE PYTHON\n",
    "\n",
    "### Este trabajo cuenta el 30% de la nota. \n",
    "\n",
    "### Resuelve los siguientes ejercicios en Python\n",
    "\n",
    "#### Utiliza tantas celdas de código como necesites"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "98d4d480",
   "metadata": {},
   "source": [
    "#### 1.- Busca la secuencia del gen CNTNAP2 (cromosma 7) del genoma humano. Descarga la secuencia en formato FASTA e introdúcela en este Notebook . (1 pto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "7640e7bb-0945-4b93-ac77-efcf5a4702dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "archivo = open(\"seq.fa\") "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "28bd9755-50a5-46bc-9e56-64287c0cf51e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<_io.TextIOWrapper name='seq.fa' mode='r' encoding='cp1252'>"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "archivo"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "400fa3f1",
   "metadata": {},
   "source": [
    "#### 2.- Muestre el encabezado y la secuencia y guarde cada uno en variables separadas. Elimine el elemento \"\\n\" del encabezado con replace() si es que lo tiene. ¿Cual es la longitud de la secuencia?. (1 pto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "e9f554f9-37f8-4b12-82fd-971c477d69ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "contenido = archivo.readlines()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 134,
   "id": "8de66c73-ffb4-4d1b-9039-ae9e2e1adda2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['>ref|NM_014141.6|:1-9454 Homo sapiens contactin associated protein 2 (CNTNAP2), mRNA\\n',\n",
       " 'CTTCAAGAACCCTACGGAGAGTCGGACTGCATCTCCGCAGCGAGCTCTTGGAGCGCCGCCGGCCGGGAGG\\n',\n",
       " 'CGAAGGATGCAGGCGGCTCCGCGCGCCGGCTGCGGGGCAGCGCTCCTGCTGTGGATTGTCAGCAGCTGCC\\n',\n",
       " 'TCTGCAGAGCCTGGACGGCTCCCTCCACGTCCCAAAAATGTGATGAGCCACTTGTCTCTGGACTCCCCCA\\n',\n",
       " 'TGTGGCTTTCAGCAGCTCCTCCTCCATCTCTGGTAGCTATTCTCCCGGCTATGCCAAGATAAACAAGAGA\\n',\n",
       " 'GGAGGTGCTGGGGGATGGTCTCCATCAGACAGCGACCATTATCAATGGCTTCAGGTTGACTTTGGCAATC\\n',\n",
       " 'GGAAGCAGATCAGTGCCATTGCAACCCAAGGAAGGTATAGCAGCTCAGATTGGGTGACCCAATACCGGAT\\n',\n",
       " 'GCTCTACAGCGACACAGGGAGAAACTGGAAACCCTATCATCAAGATGGGAATATCTGGGCATTTCCCGGA\\n',\n",
       " 'AACATTAACTCTGACGGTGTGGTCCGGCACGAATTACAGCATCCGATTATTGCCCGCTATGTGCGCATAG\\n',\n",
       " 'TGCCTCTGGATTGGAATGGAGAAGGTCGCATTGGACTCAGAATTGAAGTTTATGGCTGTTCTTACTGGGC\\n',\n",
       " 'TGATGTTATCAACTTTGATGGCCATGTTGTATTACCATATAGATTCAGAAACAAGAAGATGAAAACACTG\\n',\n",
       " 'AAAGATGTCATTGCCTTGAACTTTAAGACGTCTGAAAGTGAAGGAGTAATCCTGCACGGAGAAGGACAGC\\n',\n",
       " 'AAGGAGATTACATTACCTTGGAACTGAAAAAAGCCAAGCTGGTCCTCAGTTTAAACTTAGGAAGCAACCA\\n',\n",
       " 'GCTTGGCCCCATATATGGCCACACATCAGTGATGACAGGAAGTTTGCTGGATGACCACCACTGGCACTCT\\n',\n",
       " 'GTGGTCATTGAGCGCCAGGGGCGGAGCATTAACCTCACTCTGGACAGGAGCATGCAGCACTTCCGTACCA\\n',\n",
       " 'ATGGAGAGTTTGACTACCTGGACTTGGACTATGAGATAACCTTTGGAGGCATCCCTTTCTCTGGCAAGCC\\n',\n",
       " 'CAGCTCCAGCAGTAGAAAGAATTTCAAAGGCTGCATGGAAAGCATCAACTACAATGGCGTCAACATTACT\\n',\n",
       " 'GATCTTGCCAGAAGGAAGAAATTAGAGCCCTCAAATGTGGGAAATTTGAGCTTTTCTTGTGTGGAACCCT\\n',\n",
       " 'ATACGGTGCCTGTCTTTTTCAACGCTACAAGTTACCTGGAGGTGCCCGGACGGCTTAACCAGGACCTGTT\\n',\n",
       " 'CTCAGTCAGTTTCCAGTTTAGGACATGGAACCCCAATGGTCTCCTGGTCTTCAGTCACTTTGCGGATAAT\\n',\n",
       " 'TTGGGCAATGTGGAGATTGACCTCACTGAAAGCAAAGTGGGTGTTCACATCAACATCACACAGACCAAGA\\n',\n",
       " 'TGAGCCAAATCGATATTTCCTCAGGTTCTGGGTTGAATGATGGACAGTGGCACGAGGTTCGCTTCCTAGC\\n',\n",
       " 'CAAGGAAAATTTTGCTATTCTCACCATCGATGGAGATGAAGCATCAGCAGTTCGAACTAATAGTCCCCTT\\n',\n",
       " 'CAAGTTAAAACTGGCGAGAAGTACTTTTTTGGAGGTTTTCTGAACCAGATGAATAACTCAAGTCACTCTG\\n',\n",
       " 'TCCTTCAGCCTTCATTCCAAGGATGCATGCAGCTCATTCAAGTGGACGATCAACTTGTAAATTTATACGA\\n',\n",
       " 'AGTGGCACAAAGGAAGCCGGGAAGTTTCGCGAATGTCAGCATTGACATGTGTGCGATCATAGACAGATGT\\n',\n",
       " 'GTGCCCAATCACTGTGAGCATGGTGGAAAGTGCTCGCAAACATGGGACAGCTTCAAATGCACTTGTGATG\\n',\n",
       " 'AGACAGGATACAGTGGGGCCACCTGCCACAACTCTATCTACGAGCCTTCCTGTGAAGCCTACAAACACCT\\n',\n",
       " 'AGGACAGACATCAAATTATTACTGGATAGATCCTGATGGCAGCGGACCTCTGGGGCCTCTGAAAGTTTAC\\n',\n",
       " 'TGCAACATGACAGAGGACAAAGTGTGGACCATAGTGTCTCATGACTTGCAGATGCAGACGCCTGTGGTCG\\n',\n",
       " 'GCTACAACCCAGAAAAATACTCAGTGACACAGCTCGTTTACAGCGCCTCCATGGACCAGATAAGTGCCAT\\n',\n",
       " 'CACTGACAGTGCCGAGTACTGCGAGCAGTATGTCTCCTATTTCTGCAAGATGTCAAGATTGTTGAACACC\\n',\n",
       " 'CCAGATGGAAGCCCTTACACTTGGTGGGTTGGCAAAGCCAACGAGAAGCACTACTACTGGGGAGGCTCTG\\n',\n",
       " 'GGCCTGGAATCCAGAAATGTGCCTGCGGCATCGAACGCAACTGCACAGATCCCAAGTACTACTGTAACTG\\n',\n",
       " 'CGACGCGGACTACAAGCAATGGAGGAAGGATGCTGGTTTCTTATCATACAAAGATCACCTGCCAGTGAGC\\n',\n",
       " 'CAAGTGGTGGTTGGAGATACTGACCGTCAAGGCTCAGAAGCCAAATTGAGCGTAGGTCCTCTGCGCTGCC\\n',\n",
       " 'AAGGAGACAGGAATTATTGGAATGCCGCCTCTTTCCCAAACCCATCCTCCTACCTGCACTTCTCTACTTT\\n',\n",
       " 'CCAAGGGGAAACTAGCGCTGACATTTCTTTCTACTTCAAAACATTAACCCCCTGGGGAGTGTTTCTTGAA\\n',\n",
       " 'AATATGGGAAAGGAAGATTTCATCAAGCTGGAGCTGAAGTCTGCCACAGAAGTGTCCTTTTCATTTGATG\\n',\n",
       " 'TGGGAAATGGGCCAGTAGAGATTGTAGTGAGGTCACCAACCCCTCTCAACGATGACCAGTGGCACCGGGT\\n',\n",
       " 'CACTGCAGAGAGGAATGTCAAGCAGGCCAGCCTACAGGTGGACCGGCTACCGCAGCAGATCCGCAAGGCC\\n',\n",
       " 'CCAACAGAAGGCCACACCCGCCTGGAGCTCTACAGCCAGTTATTTGTGGGTGGTGCTGGGGGCCAGCAGG\\n',\n",
       " 'GCTTCCTGGGCTGCATCCGCTCCTTGAGGATGAATGGGGTGACACTTGACCTGGAGGAAAGAGCAAAGGT\\n',\n",
       " 'CACATCTGGGTTCATATCCGGATGCTCGGGCCATTGCACCAGCTATGGAACAAACTGTGAAAATGGAGGC\\n',\n",
       " 'AAATGCCTAGAGAGATACCACGGTTACTCCTGCGATTGCTCTAATACTGCATATGATGGAACATTTTGCA\\n',\n",
       " 'ACAAAGATGTTGGTGCATTTTTTGAAGAAGGGATGTGGCTACGATATAACTTTCAGGCACCAGCAACAAA\\n',\n",
       " 'TGCCAGAGACTCCAGCAGCAGAGTAGACAACGCTCCCGACCAGCAGAACTCCCACCCGGACCTGGCACAG\\n',\n",
       " 'GAGGAGATCCGCTTCAGCTTCAGCACCACCAAGGCGCCCTGCATTCTCCTCTACATCAGCTCCTTCACCA\\n',\n",
       " 'CAGACTTCTTGGCAGTCCTCGTCAAACCCACTGGAAGCTTACAGATTCGATACAACCTGGGTGGCACCCG\\n',\n",
       " 'AGAGCCATACAATATTGACGTAGACCACAGGAACATGGCCAATGGACAGCCCCACAGTGTCAACATCACC\\n',\n",
       " 'CGCCACGAGAAGACCATCTTTCTCAAGCTCGATCATTATCCTTCTGTGAGTTACCATCTGCCAAGTTCAT\\n',\n",
       " 'CCGACACCCTCTTCAATTCTCCCAAGTCGCTCTTTCTGGGAAAAGTTATAGAAACAGGGAAAATTGACCA\\n',\n",
       " 'AGAGATTCACAAATACAACACCCCAGGATTCACTGGTTGCCTCTCCAGAGTCCAGTTCAACCAGATCGCC\\n',\n",
       " 'CCTCTCAAGGCCGCCTTGAGGCAGACAAACGCCTCGGCTCACGTCCACATCCAGGGCGAGCTGGTGGAGT\\n',\n",
       " 'CCAACTGCGGGGCCTCGCCGCTGACCCTCTCCCCCATGTCGTCCGCCACCGACCCCTGGCACCTGGATCA\\n',\n",
       " 'CCTGGATTCAGCCAGTGCGGATTTTCCATATAATCCAGGACAAGGCCAAGCTATAAGAAATGGAGTCAAC\\n',\n",
       " 'AGAAACTCGGCTATCATTGGAGGCGTCATTGCTGTGGTGATTTTCACCATCCTGTGCACCCTGGTCTTCC\\n',\n",
       " 'TGATCCGGTACATGTTCCGCCACAAGGGCACCTACCATACCAACGAAGCAAAGGGGGCGGAGTCGGCAGA\\n',\n",
       " 'GAGCGCGGACGCCGCCATCATGAACAACGACCCCAACTTCACAGAGACCATTGATGAAAGCAAAAAGGAA\\n',\n",
       " 'TGGCTCATTTGAGGGGTGGCTACTTGGCTATGGGATAGGGAGGAGGGAATTACTAGGGAGGAGAGAAAGG\\n',\n",
       " 'GACAAAAGCACCCTGCTTCATACTCTTGAGCACATCCTTAAAATATCAGCACAAGTTGGGGGAGGCAGGC\\n',\n",
       " 'AATGGAATATAATGGAATATTCTTGAGACTGATCACAAAAAAAAAAACCTTTTTAATATTTCTTTATAGC\\n',\n",
       " 'TGAGTTTTCCCTTCTGTATCAAAACAAAATAATACAAAAAATGCTTTTAGAGTTTAAGCAATGGTTGAAA\\n',\n",
       " 'TTTGTAGGTACTATCTGTCTTATTTTGTGTGTGTTTAGAGGTGTTCTAAAGACCCGTGGTAACAGGGCAA\\n',\n",
       " 'GTTTTCTACGTTTTTAAGAGCCCTTAGAACGTGGGTATTTTTTTTCTTGAGAAAAGCTAATGCACCTACA\\n',\n",
       " 'GATGGCCCCCAACATTCTCTTCCTTTTGCTTCTAGTCAACCTTAATGGGCTGTTACAGAAACTAGTTCGT\\n',\n",
       " 'GTTTATATACTATTTCCTTTGATGTCCTATAAGTCGGAAAAGAAAGGGGCAAAGAGAACCTATTATTTGC\\n',\n",
       " 'CAGTTTTTAAGCAGAGCTCAATCTATGCCAGCTCTCTGGCATCTGGGGTTCCTGACTGATACCAGCAGTT\\n',\n",
       " 'GAAGGAAGAGAGTGCATGGCACCTGGTGTGTAACGACACAATCAGCACAACTGGAGAGAGGCATTAAAGA\\n',\n",
       " 'ACCAGGGAAGGTAGTTTGATTTTTCATTGAATTCTACAAGCTAATATTGTTCCACGTATGTAGTCTTAGA\\n',\n",
       " 'CCAATAGCTGTAACTATCAGCTGCAATACCATGGTGACCAGCTGTTACAAAAGATTTTTTCCTGTTTTAT\\n',\n",
       " 'CTGAAACATACTGGATTTATATATGTATAAGCGCCTCAATGGGGAATTAGAGCCAGATGTTATGATTTGT\\n',\n",
       " 'TTGCTCTTTTTCTTTTATAGTTTAGTTATAGCAAAAATATGGATAATTTCTAGTGAATGCATAAATTAGG\\n',\n",
       " 'TTGCGTTTCTTATTTTGCTTTAAATCTCTGGTAGTTTTTCCACCCCTGTGACACAATCCTAATAGACAGT\\n',\n",
       " 'GTCCTGTAAATGGACACAACACAATAAAGTCAAGTTATTATTGCTGTTACTCTGGATGATATGGAAAACA\\n',\n",
       " 'CTGCCATATTTTAAATCAACTACTCCACGTGTTTTTCCATCCAATCACACTGCTGTGATTCAGGGATCTT\\n',\n",
       " 'TCTTCTAAGACGGACACATTTGAACCTCAGGTTCATCACAAACCTGGTACCTGTTGCTTCCCAGAGGATG\\n',\n",
       " 'GAGAAGTGTAGTTAATCACACCTCTTAGTTTAATCTGAAATCTTGACCCAGTTATTTAACAAATAAATAC\\n',\n",
       " 'CTCATTGATTATATTTAAAAGTAATACACTTCCTGTAAACAAATGGGGACAATGCATCCAAAAAATCTTT\\n',\n",
       " 'TTAAACAGATTACACAAAAATTATTTCCAGAAAGGCTACCATTTATCATCATTATATTTCAAGCCTCTTA\\n',\n",
       " 'TACTTAATAAGCACTTTCTAAAAAGTCTTGAGATCCCACCATTCTGAGGAATTCAATATGATCACTTTTT\\n',\n",
       " 'CCTTCTTTGCCTGGGAGAGGTTAAGAGGAGGTTTCGAAGGTATAGATGCTATTGTTCTGATGGCCCGGCT\\n',\n",
       " 'GAATAAAATGGAAATTCTAGTTTGTTAGAATTATGCATTCTTTTTCAAGATTCTCAGTGTGCCTAACTTA\\n',\n",
       " 'TTGGAGCACATCAGTTTCTTGGGTAATGGAAAACATTACCTAGAGTTGCCAGTGGCACATTACACCAGTA\\n',\n",
       " 'CAGAGCACATTCCAAAGGAGACATTGGACCAGTTAATTCCCATACAAGTCAAGGTAACAGAACAAAAGGG\\n',\n",
       " 'AATCCTGATGCCCTTTTACCATTGCTGGTTGAGCTCAGGCACTGTCATGGACACCCTTAATTTTAAAAGG\\n',\n",
       " 'TTTTAATCATTCTTCTATAAAATACATTTAAAATGGAAAAATACTTAATATCACTAAATATCAGAACAAT\\n',\n",
       " 'GTAACATTTACAAATGACATATTGAAAGCAAAGGCTGTTTTATTTAGCCAAGATGATTACCATTAGGAGT\\n',\n",
       " 'TACTTTATGTATTGTTGAAAGCAAATTTTAAACATGATGTTTTAGAAGTGTTTCTGATTTTTAAACCTGG\\n',\n",
       " 'TTTACAGGTATTACTTCTGCACTTACCAAATAATGCCAGATGGAAATTTATTATTTCTTGCAATTCCCAT\\n',\n",
       " 'GATAGCTCTGTTCTTTATGCATTGTCTCAACACTTTCCCTTTTTTCCCAAAATGAGTAGAGAATTAAAGC\\n',\n",
       " 'CACCCAAAACAGCTTCTGCTACTAAAATGTTCTCATCCTTTCTCCTCCCTCTCCTTTTCCTGCCACAAAA\\n',\n",
       " 'GGTGAAAAATGAGATCCAATCCTCTCACCAAAATTTCAAACCTAGGACACTGGAATGACTGCAGGGATCA\\n',\n",
       " 'GTGGTTCTCCCATATCACCATCAATTAAGACATATAGGACACTGTCTTCCTTCAAGAGGGTTACAATGTG\\n',\n",
       " 'GCCATCAGACAGGAAACCAAACGGTGGATAAAGTATTAAGTAACTAAGTGCCAAATAAATGCTGGAAATC\\n',\n",
       " 'TTGACCTCTCCTTGGGATTATGGGTGTAACAAAAATCCCTACATCTGTTTATGAAGGCCATATTCAGTAC\\n',\n",
       " 'ATTTTAAATGGTAAATAATCTGTTTATGTGAAGAAAAAGAATTAAGTCTTTCTTCCAACTCTCTCCTTGG\\n',\n",
       " 'ATAGCCTAGCACAGTGCAGCCTCCATAACCATGACATTCCCGCCCAAGCTCTCAGTGCCTAATCCTGCTT\\n',\n",
       " 'TGTCATTCACATCTCACAAAATCTTGACATCTTACATTCCAATACATTATCAAGCAAGCACAAGTATGCT\\n',\n",
       " 'GGTAGTAGCCTCTTTAAATAATATGTATAGACAACAACAACGACAAAAAATAGACTGTTTTAAAGTTTCA\\n',\n",
       " 'GGGAAAGTTGGTGGCTGATTTAAAGTTGTGCAGGAAACATCTTCTGTGTATGAAGCAAATGTCGATGTTT\\n',\n",
       " 'TGAAAAAAGCTAGGAGATGACTTTGAATGAATGCAAGGTTAGTGAGATCCTAAGCTCTCAAAATAGCATA\\n',\n",
       " 'TTCCCTAGAGCTCAAGAAAGCTGGTCCAGGAGGTTGAAAAAGCTATTTTGTTGTTAAATTATTTTCTGGC\\n',\n",
       " 'CCTTCTTAATATTTAAAAATGTATTTCCCCTTGTGGCTTTCAACCACCTGCTCAAAAAAAGAGACTTGTT\\n',\n",
       " 'ACATGAAAGTTTTCATTAAAGAGCTGAAAACAAGAATTTAGAGAGCCATTCCTAGAAAATGTCCTACTGC\\n',\n",
       " 'CCTGCATTTGACAAACAAGCATCCTTTACTAACAAGAGCAGGAATTCAGAGGCACAAGAAAAAGCATTGG\\n',\n",
       " 'CATGAGCCAAAGAGTCTGTCTTAATGTTACTTTTGAAAATCTGCTGAGCGGCCACCATATGCAGGCTGAG\\n',\n",
       " 'AGCTGGGCACAGGCGAAGCCATTGGAAGCACTTCAGGAACAAGCACACAGCTGTGGGACTTGAACATGCA\\n',\n",
       " 'AGTGTTCAGGTTGTGTCAAGAAGCTTTTCTTTCCTTCTATGATGGAATCTGTTCTTTTCTATCCTACTTT\\n',\n",
       " 'TTTCTCTCTTCCTCTCCTCACCACATTATACCCTGCTCTTACGCAGTAAACGTTTTAATGGCCCGTTTAT\\n',\n",
       " 'GTCTCATGCCTCCAAACAACACTGAATTTGAAACCCCCCATTTTTTCTTTTCACCACCCTGTTGAGCAAT\\n',\n",
       " 'TTTCCCAAAAAAAGGGCAGCAATTATTAAATTGAATTCAAGTAAGCCAGCCAAAGATAGGTCCTAAATTG\\n',\n",
       " 'CTAGTCCCAGTAGAACCACCTGATCCTAAACCAGTGCGAAACAAACAGTAACAATGTCCCCAGCTGACTT\\n',\n",
       " 'CAGCTAAGAACCAATGGCTCCTACCCCCGCCCCGCTTTTTTTTGTTGTTTTTTGTTTTGTTTTGAGACGG\\n',\n",
       " 'AGTCTTGCTCTGTCCCCCAGGCTGGAGTGCACTGGCGCAATCTCGGGCTCACTGCAACCTCCTCCTCCTC\\n',\n",
       " 'CCACATTGAGGCGATTCTCCTGCCTCAGCCTCCCAAGTAGCTGGGATTACAGGCACCCGCCATCACACCC\\n',\n",
       " 'AGCTAATTTTTTTTTTTTTTTGTATTATTAGTAGAAGCCAGGTTTCACCATGTTGGCCAGGGTGGTCTCG\\n',\n",
       " 'AACTCCTGACCTCAAGTGATCCGTCCACCTCGGCCTTGCAAATTGCTGGGATTACAGGTGTGAGCCACCG\\n',\n",
       " 'TGCCGAGCCAGCCCCATTTTTTAAATGATGTTTTGGTTAAGAGTGGACCATGAGAATTAGCTGACAGCAT\\n',\n",
       " 'CCCCTTTCTCTCTCCCTGCCTTGGTGGGACCCTCCCTGTGTGACCTTGGTCAAGTCCTCGAACTTTTGTC\\n',\n",
       " 'CCGTATTTAAGATGGAGCTGTTTTACCTACTTCATAAGACAGTTGCGAGGTGCCATTGATTCTTGACTGC\\n',\n",
       " 'AAAATACCTTGAAACCCTTATATAAAGACTGAAGTCAACGGAGCCTAGTGAAAGACTTACTTTGTGGCTT\\n',\n",
       " 'GTGGTTGAAAGTCACATCAAAAGACAAATGTGGCCACGTTCAGGAATTGGAGACTTACTGGCATGGCTCT\\n',\n",
       " 'ACAGCTGCTCAGTTATTAATCATGCAGACTAACCTGTCAACACTGGGAGATGCAACATAGCAAAAGGACA\\n',\n",
       " 'GAGAAATTAGAATTTTTTGTGCAGAAAGCCCTAAATTCCCACCTGAATGTAACTTACAGCTCCCTTACCT\\n',\n",
       " 'ACTCTCACACATGCCCTCAAACATGCTAGATTGGCTTATACATAGGCCAACACAAAATACAAACGTGACG\\n',\n",
       " 'TGTTCATGTAGCCTAGTGGCTATATGCCTATTCTCCATGTACCCTGCATGGTAGTGCTGCAAACTTTAAA\\n',\n",
       " 'GTACATTTCTTTCACAGCAGTATTTTTTTTCATAAGTGGCATATAAATGTCATTCAATGAAATGGGGAAA\\n',\n",
       " 'TCACGTTGAGAAGTTGGTCTGTCATCTCCCATTGAGCAAAGACTGGCAGGAGATAATAAAAATAAATATG\\n',\n",
       " 'GGCACACATGTATTAATATACAGCACGCATTTACAAGTTTATTTTCCAGATAAAATTGTGCTATAAGAAC\\n',\n",
       " 'AGCTCTACCAAGACAGTCTGCACCATTTCCAAGTCTCAGTTAATTTACAGCAACTGCTGCTTTCGGAGAT\\n',\n",
       " 'GGCTGTGAAAATATGGAAGTTCCTCTCAAGTAGGCCAAGAAACAGTTCTAGATTTTACTAAGTTTTATTT\\n',\n",
       " 'TGTCAGGTTTTTTAAATTTTTTCAGTGAGCGTGGTGACTGCAGAGGTTAGTGCTGTGAAAAGCTGGGCTA\\n',\n",
       " 'AATATTCTTTCTGTAAAGTCAAACAGGATTCCATCCCCTGTGAAATAACACAAAATTTCACTCTCTAAAA\\n',\n",
       " 'GCAACAGCATGTAAACTAGAATGAAAGAAGGAAATTATGTACGTATGCCTAATATTCTTTGTGAATGTCT\\n',\n",
       " 'TTCATTTAACTAAAATTATATTAGAAACCAGATTGATAAATAAAAAATTCAAAGTAGTTTTAATTATCCT\\n',\n",
       " 'AAAA\\n']"
      ]
     },
     "execution_count": 134,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "contenido"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 176,
   "id": "b959c036-4ce2-4acf-9556-d57e841b860d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Variables creadas.\n"
     ]
    }
   ],
   "source": [
    "encabezado = contenido[0]\n",
    "lineas_secuencia = contenido[1:]\n",
    "sec_bruto = \"\".join(lineas_secuencia)\n",
    "print(\"Variables creadas.\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "3ea2b4ba-20a7-4ef7-a5fa-c6dd136d0e34",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "Encabezado limpio: >ref|NM_014141.6|:1-9454 Homo sapiens contactin associated protein 2 (CNTNAP2), mRNA\n"
     ]
    }
   ],
   "source": [
    "encabezado_final = encabezado.replace('\\n', '')\n",
    "secuencia_final = sec_bruto.replace('\\n', '')\n",
    "print(\"-\" * 30)\n",
    "print(f\"Encabezado limpio: {encabezado_final}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "84e02d56-d9d5-4395-9559-3deba0aa6fd7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "------------------------------\n",
      "La longitud de la secuencia es: *9454*\n"
     ]
    }
   ],
   "source": [
    "longitud_secuencia = len(secuencia_final)\n",
    "print(\"-\" * 30)\n",
    "print(f\"La longitud de la secuencia es: *{longitud_secuencia}*\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36b8c00d",
   "metadata": {},
   "source": [
    "#### 3.- Para el encabezado, extrae empleando expresiones regulares el identificador. (1pto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "id": "d845bb81",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'NM_014141.6'"
      ]
     },
     "execution_count": 174,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import re\n",
    "m=re.search(r\"[A-Z]{2}\\_[0-9]{6}\\.[0-9]\",encabezado2)\n",
    "identificador = m.group()\n",
    "identificador"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f38fdda0",
   "metadata": {},
   "source": [
    "#### 4.- ¿Cuál es el porcentaje de GC de la secuencia? (1 pto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "id": "2914b1f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "num_G = secuencia_final.count('G')\n",
    "num_C = secuencia_final.count('C')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "86685253-a985-4272-9a11-b2d0c02babcf",
   "metadata": {},
   "outputs": [],
   "source": [
    "total_GC = num_G + num_C\n",
    "porcentaje_GC = (total_GC / longitud_secuencia) * 100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "id": "cb47377c-f51f-46df-a128-4dd8d856f2a7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total de bases G: 2012\n",
      "Total de bases C: 2150\n",
      "Porcentaje de GC: *44.02%*\n"
     ]
    }
   ],
   "source": [
    "print(f\"Total de bases G: {num_G}\")\n",
    "print(f\"Total de bases C: {num_C}\")\n",
    "print(f\"Porcentaje de GC: *{porcentaje_GC:.2f}%*\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a28888dd",
   "metadata": {},
   "source": [
    "#### 5.- Devuelve la secuencia de ARN que surgiría a partir de la siguiente secuencia. Recuerda que la secuencia de ARN resultante tiene que ser complementaria a la de ADN. (1 pto)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "id": "b27feabb",
   "metadata": {},
   "outputs": [],
   "source": [
    "secuencia_ADN = secuencia_final\n",
    "secuencia_ARN = secuencia_ADN.replace('T', 'a') "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "id": "e878f6c3-31a3-4796-8876-ae1c282dc9cc",
   "metadata": {},
   "outputs": [],
   "source": [
    "secuencia_ARN = secuencia_ARN.replace('A', 'u')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 196,
   "id": "c88ca4a0-62a4-4c9a-bb18-1fdd10751ecc",
   "metadata": {},
   "outputs": [],
   "source": [
    "secuencia_ARN = secuencia_ARN.replace('C', 'g')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 200,
   "id": "eeafa518-361d-4c4f-b8cd-aece9c8b4111",
   "metadata": {},
   "outputs": [],
   "source": [
    "secuencia_ARN = secuencia_ARN.replace('G', 'c')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "id": "0dd3fc4e-2a57-4b07-a3d6-0491049ede45",
   "metadata": {},
   "outputs": [],
   "source": [
    "secuencia_ARN = secuencia_ARN.upper()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 208,
   "id": "ccb823d8-be44-4655-8f1e-171033a69c36",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Secuencia de ADN (inicio): CTTCAAGAACCCTACGGAGAGTCGGACTGC...\n",
      "Secuencia de ARN (inicio): GAAGUUCUUGGGAUGCCUCUCAGCCUGACG...\n"
     ]
    }
   ],
   "source": [
    "print(f\"Secuencia de ADN (inicio): {secuencia_final[:30]}...\") \n",
    "print(f\"Secuencia de ARN (inicio): {secuencia_ARN[:30]}...\")\n",
    "secuencia_ARN_resultante = secuencia_ARN"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9f94d5dd",
   "metadata": {},
   "source": [
    "#### 6.- Realiza una función que realice una digestión con las siguientes enzimas de restricción en nuestra secuencia. La función tiene que devolver la siguiente información: (2 pto)\n",
    "1. Enzimas que tienen sitios de corte en la secuencia y posición (o posiciones de corte)\n",
    "2. Enzimas que no tienen sitios de corte (si las hay)\n",
    "3. Resultado de la digestión: los fragmentos resultantes de nuestra secuencia\n",
    "4. Indicar número y tamaño de cada fragmento"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "id": "1cab833c",
   "metadata": {},
   "outputs": [],
   "source": [
    "enzR = {\n",
    "    'HindIII' : 'A*AGCTT',\n",
    "    'BamHI' : 'G*GATCC',\n",
    "    'AluI' : 'AG*CT',\n",
    "    'Sau3AI' : '*GATC',\n",
    "    'EcoRI' : 'G*AATTC'\n",
    "}\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 214,
   "id": "814074ce-5c2e-4553-891f-a9199722789b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import re\n",
    "def digestion(secuencia, enzR):\n",
    "    secuencia = secuencia.upper()\n",
    "    \n",
    "    enzimas_con_corte = {}\n",
    "    enzimas_sin_corte = []\n",
    "    \n",
    "    for enzima, patron in enzR.items():\n",
    "        partes = patron.split('*')\n",
    "        antes = partes[0]\n",
    "        despues = partes[1]\n",
    "        sitio = antes + despues \n",
    "        \n",
    "        posiciones = []\n",
    "        start = 0\n",
    "        \n",
    "        while True:\n",
    "            idx = secuencia.find(sitio, start)\n",
    "            if idx == -1:\n",
    "                break\n",
    "            \n",
    "            corte = idx + len(antes) + 1 \n",
    "            posiciones.append(corte)\n",
    "            \n",
    "           \n",
    "            start = idx + 1\n",
    "        \n",
    "        if posiciones:\n",
    "            enzimas_con_corte[enzima] = posiciones\n",
    "        else:\n",
    "            enzimas_sin_corte.append(enzima)\n",
    "    \n",
    "    cortes_totales = set()\n",
    "    for pos_list in enzimas_con_corte.values():\n",
    "        cortes_totales.update(pos_list)\n",
    "    \n",
    "    cortes_totales = sorted(list(cortes_totales))\n",
    "    \n",
    "    fragmentos = []\n",
    "    inicio_index = 0 \n",
    "    \n",
    "    for corte_pos_base1 in cortes_totales:\n",
    "        corte_index = corte_pos_base1 - 1 \n",
    "        \n",
    "        fragmento = secuencia[inicio_index:corte_index]\n",
    "        if fragmento: \n",
    "            fragmentos.append(fragmento)\n",
    "            \n",
    "        inicio_index = corte_index \n",
    "\n",
    "    ultimo_fragmento = secuencia[inicio_index:]\n",
    "    if ultimo_fragmento:\n",
    "        fragmentos.append(ultimo_fragmento)\n",
    "\n",
    "    \n",
    "    resumen_fragmentos = []\n",
    "    for i, frag in enumerate(fragmentos):\n",
    "        resumen_fragmentos.append(f\"Fragmento {i+1} (tamaño: {len(frag)})\")\n",
    "        \n",
    "    return {\n",
    "        \"enzimas_con_corte\": enzimas_con_corte,\n",
    "        \"enzimas_sin_corte\": enzimas_sin_corte,\n",
    "        \"fragmentos_resultantes\": fragmentos,\n",
    "        \"resumen\": resumen_fragmentos\n",
    "    }\n",
    "\n",
    "reporte_digest = digestion(secuencia_final, enzR)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "id": "35e10533-5aad-4bec-bb1b-cd994176cfcb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "--- 1. Enzimas que cortan y sus posiciones ---\n",
      "HindIII: [3326, 7512]\n",
      "AluI: [45, 136, 226, 247, 394, 809, 842, 1054, 1171, 1643, 1801, 2063, 2618, 2624, 2828, 2983, 3238, 3280, 3328, 3458, 3701, 3831, 4270, 4467, 4637, 4652, 4801, 4838, 4851, 4872, 5914, 6236, 6313, 6769, 7010, 7055, 7081, 7091, 7113, 7234, 7423, 7471, 7514, 7834, 7844, 8021, 8053, 8251, 8348, 8545, 8670, 9033, 9233]\n",
      "Sau3AI: [358, 1121, 1658, 1735, 1919, 2288, 2363, 2788, 3226, 3461, 3634, 3776, 3922, 4231, 5245, 5562, 5590, 6383, 6436, 7046, 7792, 8138]\n",
      "EcoRI: [4790, 5580, 7323, 7734]\n",
      "\n",
      "--- 2. Enzimas que no cortan ---\n",
      "['BamHI']\n",
      "\n",
      "--- 3. Fragmentos Resultantes (Digestión Múltiple) ---\n",
      "Primeros 3 fragmentos: ['CTTCAAGAACCCTACGGAGAGTCGGACTGCATCTCCGCAGCGAG', 'CTCTTGGAGCGCCGCCGGCCGGGAGGCGAAGGATGCAGGCGGCTCCGCGCGCCGGCTGCGGGGCAGCGCTCCTGCTGTGGATTGTCAGCAG', 'CTGCCTCTGCAGAGCCTGGACGGCTCCCTCCACGTCCCAAAAATGTGATGAGCCACTTGTCTCTGGACTCCCCCATGTGGCTTTCAGCAG']\n",
      "(Total de fragmentos: 82)\n",
      "\n",
      "--- 4. Número y Tamaño de Cada Fragmento ---\n",
      "Fragmento 1 (tamaño: 44)\n",
      "Fragmento 2 (tamaño: 91)\n",
      "Fragmento 3 (tamaño: 90)\n",
      "Fragmento 4 (tamaño: 21)\n",
      "Fragmento 5 (tamaño: 111)\n",
      "Fragmento 6 (tamaño: 36)\n",
      "Fragmento 7 (tamaño: 415)\n",
      "Fragmento 8 (tamaño: 33)\n",
      "Fragmento 9 (tamaño: 212)\n",
      "Fragmento 10 (tamaño: 67)\n",
      "Fragmento 11 (tamaño: 50)\n",
      "Fragmento 12 (tamaño: 472)\n",
      "Fragmento 13 (tamaño: 15)\n",
      "Fragmento 14 (tamaño: 77)\n",
      "Fragmento 15 (tamaño: 66)\n",
      "Fragmento 16 (tamaño: 118)\n",
      "Fragmento 17 (tamaño: 144)\n",
      "Fragmento 18 (tamaño: 225)\n",
      "Fragmento 19 (tamaño: 75)\n",
      "Fragmento 20 (tamaño: 255)\n",
      "Fragmento 21 (tamaño: 6)\n",
      "Fragmento 22 (tamaño: 164)\n",
      "Fragmento 23 (tamaño: 40)\n",
      "Fragmento 24 (tamaño: 155)\n",
      "Fragmento 25 (tamaño: 243)\n",
      "Fragmento 26 (tamaño: 12)\n",
      "Fragmento 27 (tamaño: 42)\n",
      "Fragmento 28 (tamaño: 46)\n",
      "Fragmento 29 (tamaño: 2)\n",
      "Fragmento 30 (tamaño: 130)\n",
      "Fragmento 31 (tamaño: 3)\n",
      "Fragmento 32 (tamaño: 173)\n",
      "Fragmento 33 (tamaño: 67)\n",
      "Fragmento 34 (tamaño: 75)\n",
      "Fragmento 35 (tamaño: 55)\n",
      "Fragmento 36 (tamaño: 91)\n",
      "Fragmento 37 (tamaño: 309)\n",
      "Fragmento 38 (tamaño: 39)\n",
      "Fragmento 39 (tamaño: 197)\n",
      "Fragmento 40 (tamaño: 170)\n",
      "Fragmento 41 (tamaño: 15)\n",
      "Fragmento 42 (tamaño: 138)\n",
      "Fragmento 43 (tamaño: 11)\n",
      "Fragmento 44 (tamaño: 37)\n",
      "Fragmento 45 (tamaño: 13)\n",
      "Fragmento 46 (tamaño: 21)\n",
      "Fragmento 47 (tamaño: 373)\n",
      "Fragmento 48 (tamaño: 317)\n",
      "Fragmento 49 (tamaño: 18)\n",
      "Fragmento 50 (tamaño: 10)\n",
      "Fragmento 51 (tamaño: 324)\n",
      "Fragmento 52 (tamaño: 322)\n",
      "Fragmento 53 (tamaño: 77)\n",
      "Fragmento 54 (tamaño: 70)\n",
      "Fragmento 55 (tamaño: 53)\n",
      "Fragmento 56 (tamaño: 333)\n",
      "Fragmento 57 (tamaño: 241)\n",
      "Fragmento 58 (tamaño: 36)\n",
      "Fragmento 59 (tamaño: 9)\n",
      "Fragmento 60 (tamaño: 26)\n",
      "Fragmento 61 (tamaño: 10)\n",
      "Fragmento 62 (tamaño: 22)\n",
      "Fragmento 63 (tamaño: 121)\n",
      "Fragmento 64 (tamaño: 89)\n",
      "Fragmento 65 (tamaño: 100)\n",
      "Fragmento 66 (tamaño: 48)\n",
      "Fragmento 67 (tamaño: 41)\n",
      "Fragmento 68 (tamaño: 2)\n",
      "Fragmento 69 (tamaño: 220)\n",
      "Fragmento 70 (tamaño: 58)\n",
      "Fragmento 71 (tamaño: 42)\n",
      "Fragmento 72 (tamaño: 10)\n",
      "Fragmento 73 (tamaño: 177)\n",
      "Fragmento 74 (tamaño: 32)\n",
      "Fragmento 75 (tamaño: 85)\n",
      "Fragmento 76 (tamaño: 113)\n",
      "Fragmento 77 (tamaño: 97)\n",
      "Fragmento 78 (tamaño: 197)\n",
      "Fragmento 79 (tamaño: 125)\n",
      "Fragmento 80 (tamaño: 363)\n",
      "Fragmento 81 (tamaño: 200)\n",
      "Fragmento 82 (tamaño: 222)\n"
     ]
    }
   ],
   "source": [
    "print(\"--- 1. Enzimas que cortan y sus posiciones ---\")\n",
    "if reporte_digest['enzimas_con_corte']:\n",
    "    for enz, pos in reporte_digest['enzimas_con_corte'].items():\n",
    "        print(f\"{enz}: {pos}\")\n",
    "else:\n",
    "    print(\"Ninguna enzima tiene sitios de corte.\")\n",
    "\n",
    "print(\"\\n--- 2. Enzimas que no cortan ---\")\n",
    "if reporte_digest['enzimas_sin_corte']:\n",
    "    print(f\"{reporte_digest['enzimas_sin_corte']}\")\n",
    "else:\n",
    "    print(\"Ninguna\")\n",
    "\n",
    "print(\"\\n--- 3. Fragmentos Resultantes (Digestión Múltiple) ---\")\n",
    "if reporte_digest['fragmentos_resultantes']:\n",
    "    print(\"Primeros 3 fragmentos:\", reporte_digest['fragmentos_resultantes'][:3])\n",
    "    print(f\"(Total de fragmentos: {len(reporte_digest['fragmentos_resultantes'])})\")\n",
    "else:\n",
    "    print(\"No se generaron fragmentos (No hay sitios de corte).\")\n",
    "\n",
    "print(\"\\n--- 4. Número y Tamaño de Cada Fragmento ---\")\n",
    "for resumen in reporte_digest['resumen']:\n",
    "    print(resumen)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cae3c937",
   "metadata": {},
   "source": [
    "#### 7.- Realiza una función que mediante la introducción de una secuencia de ADN devuelva lo siguiente: (3pto)\n",
    "1. Todos los ORFs posibles que puedan surgir de la secuencia.\n",
    "2. Selecciona los 6 ORFs más largos e indica si corresponden a la strand positiva o negativa.\n",
    "3. Devuelve como mejor predicción, el más largo de todos.\n",
    "4. Calcula el porcentaje de aminoácidos aromáticos de esa proteína elegida y su longitud relativa a la secuencia original de ADN."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 221,
   "id": "407c9d54-5ba3-42b8-9796-b110d4a8ffd1",
   "metadata": {},
   "outputs": [],
   "source": [
    "def analizar_orfs_y_proteinas_std(adn_secuencia_str):\n",
    "    \n",
    "    TRADUCCION = {\n",
    "        'TTT': 'F', 'TTC': 'F', 'TTA': 'L', 'TTG': 'L', 'CTT': 'L', 'CTC': 'L',\n",
    "        'CTA': 'L', 'CTG': 'L', 'ATT': 'I', 'ATC': 'I', 'ATA': 'I', 'ATG': 'M',\n",
    "        'GTT': 'V', 'GTC': 'V', 'GTA': 'V', 'GTG': 'V', 'TCT': 'S', 'TCC': 'S',\n",
    "        'TCA': 'S', 'TCG': 'S', 'CCT': 'P', 'CCC': 'P', 'CCA': 'P', 'CCG': 'P',\n",
    "        'ACT': 'T', 'ACC': 'T', 'ACA': 'T', 'ACG': 'T', 'GCT': 'A', 'GCC': 'A',\n",
    "        'GCA': 'A', 'GCG': 'A', 'TAT': 'Y', 'TAC': 'Y', 'TAA': '', 'TAG': '',\n",
    "        'CAT': 'H', 'CAC': 'H', 'CAA': 'Q', 'CAG': 'Q', 'AAT': 'N', 'AAC': 'N',\n",
    "        'AAA': 'K', 'AAG': 'K', 'GAT': 'D', 'GAC': 'D', 'GAA': 'E', 'GAG': 'E',\n",
    "        'TGT': 'C', 'TGC': 'C', 'TGA': '*', 'TGG': 'W', 'CGT': 'R', 'CGC': 'R',\n",
    "        'CGA': 'R', 'CGG': 'R', 'AGT': 'S', 'AGC': 'S', 'AGA': 'R', 'AGG': 'R',\n",
    "        'GGT': 'G', 'GGC': 'G', 'GGA': 'G', 'GGG': 'G'\n",
    "    }\n",
    "\n",
    "    AA_AROMATICOS = {'W', 'Y', 'F'}\n",
    "    COMPLEMENTO = str.maketrans('ATCG', 'TAGC')\n",
    "\n",
    "    def traducir_orf_integrada(orf_adn):\n",
    "        proteina = \"\"\n",
    "        for i in range(0, len(orf_adn), 3):\n",
    "            codon = orf_adn[i:i+3]\n",
    "            if len(codon) < 3: break\n",
    "            aa = TRADUCCION.get(codon, 'X')\n",
    "            if aa == '*': break\n",
    "            proteina += aa\n",
    "        return proteina\n",
    "\n",
    "\n",
    "    adn_secuencia = adn_secuencia_str.upper()\n",
    "    orfs_encontrados = []\n",
    "    \n",
    "    adn_reversa_comp = adn_secuencia.translate(COMPLEMENTO)[::-1]\n",
    "    \n",
    "    secuencias_a_analizar = [\n",
    "        (adn_secuencia, 1, 'Positiva'),\n",
    "        (adn_secuencia, 2, 'Positiva'),\n",
    "        (adn_secuencia, 3, 'Positiva'),\n",
    "        (adn_reversa_comp, 1, 'Negativa'),\n",
    "        (adn_reversa_comp, 2, 'Negativa'),\n",
    "        (adn_reversa_comp, 3, 'Negativa'),\n",
    "    ]\n",
    "\n",
    "    for seq_completa, frame, strand in secuencias_a_analizar:\n",
    "        secuencia_frame = seq_completa[frame - 1:]\n",
    "        start_index = secuencia_frame.find('ATG')\n",
    "        \n",
    "        while start_index != -1:\n",
    "            orf_adn = secuencia_frame[start_index:]\n",
    "            proteina = traducir_orf_integrada(orf_adn)\n",
    "            \n",
    "            if len(proteina) > 0:\n",
    "                frame_id = f'{strand} ({\"+\" if strand == \"Positiva\" else \"-\"}{frame})'\n",
    "                orfs_encontrados.append({\n",
    "                    'longitud_AA': len(proteina),\n",
    "                    'secuencia_AA': proteina,\n",
    "                    'strand': strand,\n",
    "                    'frame_id': frame_id\n",
    "                })\n",
    "            \n",
    "            start_index = secuencia_frame.find('ATG', start_index + 3)\n",
    "\n",
    "    orfs_encontrados.sort(key=lambda x: x['longitud_AA'], reverse=True)\n",
    "    top_6_orfs = orfs_encontrados[:6]\n",
    "    mejor_prediccion = top_6_orfs[0] if top_6_orfs else {'longitud_AA': 0, 'secuencia_AA': ''}\n",
    "    \n",
    "    proteina_elegida = mejor_prediccion['secuencia_AA']\n",
    "    longitud_proteina = len(proteina_elegida)\n",
    "    \n",
    "    conteo_aromaticos = 0\n",
    "    for aa in proteina_elegida:\n",
    "        if aa in AA_AROMATICOS:\n",
    "            conteo_aromaticos += 1\n",
    "            \n",
    "    longitud_adn_original = len(adn_secuencia_str)\n",
    "    \n",
    "    porcentaje_aromaticos = (conteo_aromaticos / longitud_proteina) * 100 if longitud_proteina > 0 else 0\n",
    "    longitud_relativa = (longitud_proteina * 3 / longitud_adn_original) * 100 if longitud_adn_original > 0 else 0\n",
    "    \n",
    "    return {\n",
    "        \"orfs_totales\": orfs_encontrados,\n",
    "        \"top_6_orfs\": top_6_orfs,\n",
    "        \"mejor_prediccion\": mejor_prediccion,\n",
    "        \"analisis_proteina\": {\n",
    "            \"longitud_AA\": longitud_proteina,\n",
    "            \"porcentaje_aromaticos\": porcentaje_aromaticos,\n",
    "            \"longitud_relativa_ADN\": longitud_relativa\n",
    "        }\n",
    "    }"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "id": "76a56cf3-1bf8-462d-87b2-06fc4fab5f37",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "============================================================\n",
      "             REPORTE FINAL - ANÁLISIS DE ORFS Y PROTEÍNAS\n",
      "============================================================\n",
      "## 1. Todos los ORFs posibles (Mostrando Top 6 más largos)\n",
      "  1. Frame Positiva (+1): 1331 AA\n",
      "  2. Frame Positiva (+2): 1331 AA\n",
      "  3. Frame Positiva (+3): 1331 AA\n",
      "  4. Frame Positiva (+1): 1217 AA\n",
      "  5. Frame Positiva (+2): 1217 AA\n",
      "  6. Frame Positiva (+3): 1217 AA\n",
      "------------------------------------------------------------\n",
      "## 2. Top 6 ORFs más largos (Longitud e Indica Strand)\n",
      "  1. Longitud: 1331 AA. Strand: *Positiva*\n",
      "  2. Longitud: 1331 AA. Strand: *Positiva*\n",
      "  3. Longitud: 1331 AA. Strand: *Positiva*\n",
      "  4. Longitud: 1217 AA. Strand: *Positiva*\n",
      "  5. Longitud: 1217 AA. Strand: *Positiva*\n",
      "  6. Longitud: 1217 AA. Strand: *Positiva*\n",
      "------------------------------------------------------------\n",
      "## 3. Mejor Predicción (ORF Más Largo)\n",
      "  > *Longitud (AA):* 1331 aminoácidos\n",
      "  > *Frame/Strand:* Positiva (+1)\n",
      "  > *Secuencia (inicio):* MQAAPRAGCGAALLLWIVSSCLCRAWTAPSTSQKCDEPLVSGLPHVAFSS...\n",
      "------------------------------------------------------------\n",
      "## 4. Análisis de la Proteína Elegida\n",
      "  - Porcentaje de AA Aromáticos (W, Y, F): *10.59%*\n",
      "  - Longitud relativa del ORF al ADN original: *42.24%*\n"
     ]
    }
   ],
   "source": [
    "reporte_final = analizar_orfs_y_proteinas_std(secuencia_final)\n",
    "\n",
    "print(\"=\" * 60)\n",
    "print(\"             REPORTE FINAL - ANÁLISIS DE ORFS Y PROTEÍNAS\")\n",
    "print(\"=\" * 60)\n",
    "\n",
    "print(\"## 1. Todos los ORFs posibles (Mostrando Top 6 más largos)\")\n",
    "for i, orf in enumerate(reporte_final['top_6_orfs']):\n",
    "    print(f\"  {i+1}. Frame {orf['frame_id']}: {orf['longitud_AA']} AA\")\n",
    "\n",
    "print(\"-\" * 60)\n",
    "\n",
    "print(\"## 2. Top 6 ORFs más largos (Longitud e Indica Strand)\")\n",
    "for i, orf in enumerate(reporte_final['top_6_orfs']):\n",
    "    print(f\"  {i+1}. Longitud: {orf['longitud_AA']} AA. Strand: *{orf['strand']}*\")\n",
    "\n",
    "print(\"-\" * 60)\n",
    "\n",
    "mejor = reporte_final['mejor_prediccion']\n",
    "print(\"## 3. Mejor Predicción (ORF Más Largo)\")\n",
    "print(f\"  > *Longitud (AA):* {mejor['longitud_AA']} aminoácidos\")\n",
    "print(f\"  > *Frame/Strand:* {mejor['frame_id']}\")\n",
    "print(f\"  > *Secuencia (inicio):* {mejor['secuencia_AA'][:50]}...\")\n",
    "\n",
    "print(\"-\" * 60)\n",
    "\n",
    "analisis = reporte_final['analisis_proteina']\n",
    "print(\"## 4. Análisis de la Proteína Elegida\")\n",
    "print(f\"  - Porcentaje de AA Aromáticos (W, Y, F): *{analisis['porcentaje_aromaticos']:.2f}%*\")\n",
    "print(f\"  - Longitud relativa del ORF al ADN original: *{analisis['longitud_relativa_ADN']:.2f}%*\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python [conda env:base] *",
   "language": "python",
   "name": "conda-base-py"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
